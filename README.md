# 云谷评价系统批量操作助手

一个专为云谷学校评估成长画像系统设计的Tampermonkey用户脚本，旨在提升学生评价工作效率。

## 📋 功能简介

该脚本为云谷评价系统添加了一个可拖拽的批量操作面板，包含三个核心功能按钮，帮助教师快速完成学生评价工作：

### 🎯 主要功能

1. **保存下一个** - 自动保存当前学生评价并切换到下一个学生
2. **提交下一个** - 自动提交当前学生评价并切换到下一个学生  
3. **编辑** - 快速进入当前学生的编辑模式

### ✨ 核心特性

- 🖱️ **可拖拽面板** - 操作面板支持拖拽移动，位置自动保存
- 🔄 **智能切换** - 完成操作后自动跳转到下一个待评价学生
- 🎨 **友好界面** - 深色半透明设计，不干扰原页面内容
- 🔧 **React兼容** - 专门优化以适配云谷系统的React框架
- 💾 **状态记忆** - 面板位置和设置会被自动保存

## 📱 界面预览

操作面板包含：
- **标题栏** - 显示"批量操作"，可用于拖拽移动
- **保存下一个** - 蓝色按钮，执行保存并切换操作
- **提交下一个** - 绿色按钮，执行提交并切换操作  
- **编辑** - 黄色按钮，快速进入编辑模式

## 🚀 安装指南

### 前置要求
1. 安装 [Tampermonkey](https://www.tampermonkey.net/) 浏览器扩展
2. 支持的浏览器：Chrome、Firefox、Edge、Safari 等

### 安装步骤
1. 复制脚本内容：点击 [yungu-batch-operations.user.js](./yungu-batch-operations.user.js)
2. 点击页面上方的 "Raw" 按钮查看原始代码
3. 复制所有代码内容
4. 打开 Tampermonkey 控制面板
5. 点击 "创建新脚本"
6. 粘贴代码并保存
7. 访问云谷评价系统即可看到操作面板

### 快速安装（推荐）
直接点击此链接安装：
```
https://raw.githubusercontent.com/ygwinnie/yungu-evaluation-assistant/main/yungu-batch-operations.user.js
```

## 📖 使用说明

### 基本操作

1. **启动脚本**
   - 访问云谷评价系统页面
   - 脚本会自动加载，右下角出现操作面板
   - 系统会显示"批量操作面板已启动"的通知

2. **移动面板**
   - 点击面板标题区域进行拖拽
   - 松开鼠标后位置会自动保存
   - 下次访问时面板会出现在上次的位置

3. **使用功能**
   - **保存下一个**：完成当前学生评价保存，自动切换到下一个学生
   - **提交下一个**：完成当前学生评价提交，自动切换到下一个学生
   - **编辑**：快速点击页面的编辑按钮，进入编辑模式

### 工作流程示例

**批量评价场景：**
1. 打开学生评价页面
2. 完成当前学生的评价填写
3. 点击"保存下一个"或"提交下一个"
4. 系统自动保存/提交并切换到下一个学生
5. 重复步骤2-4，直到完成所有学生评价

**快速编辑场景：**
1. 浏览学生评价列表
2. 点击"编辑"按钮快速进入编辑模式
3. 修改评价内容
4. 使用其他按钮保存并继续

## ⚙️ 技术特性

### React框架适配
- **智能元素识别** - 自动识别并处理React动态渲染的DOM元素
- **事件兼容性** - 使用多种事件触发方式确保与React组件兼容
- **DOM更新处理** - 正确处理React状态更新后的DOM变化

### 智能重试机制
- **元素重新获取** - 操作前后重新获取DOM元素引用
- **多重点击策略** - 包括元素点击、子元素点击、精确坐标点击
- **操作验证** - 自动验证操作是否成功，失败时尝试备用方案

### 用户体验优化
- **实时反馈** - 每个操作都有相应的通知消息
- **视觉辅助** - 目标元素会短暂高亮显示
- **错误处理** - 完善的错误处理和用户提示

## 🔧 适用页面

脚本会在以下页面自动激活：
- `https://task.yungu.org/*` - 云谷任务系统
- `https://evaluation.yungu.org/*` - 云谷评价系统

## 🐛 故障排除

### 常见问题

**Q: 脚本没有显示操作面板？**
A: 
1. 检查Tampermonkey是否已启用
2. 确认当前页面URL匹配脚本设置
3. 刷新页面重新加载脚本
4. 查看浏览器控制台是否有错误信息

**Q: 点击按钮没有反应？**
A:
1. 确认页面元素已完全加载
2. 查看通知消息了解具体错误
3. 尝试手动刷新页面
4. 检查是否有其他脚本冲突

**Q: 学生切换失败？**
A:
1. 脚本会自动尝试多种切换方法
2. 注意观察高亮显示的目标学生
3. 如多次尝试失败，可手动点击学生完成切换

### 调试信息
脚本会在浏览器控制台输出详细的调试信息，包括：
- 元素查找过程
- 点击事件执行情况  
- 学生切换验证结果
- 错误信息和重试过程

## 📜 更新日志

### v1.3 (2025-06-26)
- ✨ 新增可拖拽的三按钮操作面板
- ✨ 添加"提交下一个"功能
- ✨ 添加"编辑"快捷按钮
- 🔧 优化React框架兼容性
- 🔧 改进学生切换成功率
- 🎨 全新的界面设计

### v1.2 (2025-06-26)
- 🔧 修复React DOM更新导致的元素失效问题
- 🔧 增强学生姓名元素点击策略
- 📈 提升学生切换成功率

### v1.1 (2025-06-26)
- ✨ 添加智能重试机制
- 🔧 优化点击事件兼容性
- 📱 改进用户反馈通知

### v1.0 (2025-06-26)
- 🎉 首次发布
- ✨ 基础的保存下一个功能
- 🔧 React框架兼容

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个脚本！

### 开发环境
1. Fork本仓库
2. 修改 `yungu-batch-operations.user.js` 文件
3. 在Tampermonkey中测试修改
4. 提交Pull Request

### 反馈渠道
- [GitHub Issues](https://github.com/ygwinnie/yungu-evaluation-assistant/issues) - 报告问题或建议功能
- [GitHub Discussions](https://github.com/ygwinnie/yungu-evaluation-assistant/discussions) - 使用交流和经验分享

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## ⚠️ 免责声明

- 本脚本仅用于提升工作效率，请遵守学校相关规定
- 使用前请确保了解脚本功能，避免误操作
- 作者不对使用脚本造成的任何问题承担责任
- 脚本可能因为云谷系统更新而需要维护

## 🌟 致谢

感谢云谷学校提供的评价系统，以及所有使用和改进此脚本的教师们！

---

如果这个脚本对您有帮助，请给项目一个 ⭐ Star！